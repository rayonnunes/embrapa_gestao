<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>Cadastrar Estrutura da Propriedade - Emprapa</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      content="A fully featured admin theme which can be used to build CRM, CMS, etc."
      name="description"
    />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico" />

    <!-- Bootstrap select pluings -->
    <link
      href="assets/libs/bootstrap-select/bootstrap-select.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- App css -->
    <link
      href="assets/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="bg-white">
    <div id="wrapper">
      @@include('./partials/topbar-initial.html')
    </div>
    <div class="account-pages my-5">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-8 col-lg-6 col-xl-5">
            <div>
              <div class="text-center mb-4">
                <h2>Cadastrar Estrutura da Propriedade</h2>
                <h3>
                  Animais de Trabalho
                </h3>
              </div>

              <form id="form-animais-trabalho">
                <div class="form-group mb-3">
                  <label for="animais-trabalho"
                    >Selecione o Animal de Trabalho</label
                  >
                  <select class="form-control select2" id="animais-trabalho" onchange="adicionarOutro()" name="nome-animal">
                    <option>Selecione</option>
                    <optgroup label="Animais de Trabalho">
                      <option value="Cavalo">Cavalos (Equinos)</option>
                      <option value="Jumentos (Asininos)">Jumentos (Asininos)</option>
                      <option value="Bois (Bovinos)">Bois (Bovinos)</option>
                      <option value="Burros (Muares)">Burros (Muares)</option>
                      <option value="Cães (Caninos)">Cães (Caninos)</option>
                      <option value="-1">Outro (Informe...)</option>
                    </optgroup>
                  </select>
                </div>

                <div class="form-group d-none" id="outro-animal-div">
                  <label for="outra-benfeitoria-nome-1">Outro</label>
                  <input
                    id="outro-animal"
                    type="text"
                    class="form-control"
                    name="outro"
                  />
                </div>

                <div class="form-group mb-3">
                  <label for="detalhes-benfeitoria-principal-1"
                    >Características</label
                  >
                  <input
                    id="detalhes-benfeitoria-principal-1"
                    type="text"
                    class="form-control"
                    name="caracteristica"
                  />
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="quantidade-benfeitoria-principal-1"
                        >Quantidade</label
                      >
                      <input
                        id="quantidade-benfeitoria-principal-1"
                        type="number"
                        class="form-control"
                        name="qtd"
                      />
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="valor-benfeitoria-1">Valor</label>
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >R$</span
                          >
                        </div>
                        <input
                          id="valor-animal"
                          type="text"
                          class="form-control"
                          data-toggle="input-mask"
                          data-mask-format="000.000.000.000.000,00"
                          data-reverse="true"
                          name="valor"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="vida-util-benfeitoria-1">Vida Útil (anos)</label>
                      <div class="input-group">
                        <input
                          class="form-control"
                          type="number"
                          id="vida-util-benfeitoria-1"
                          name="vida-util"
                        />                        
                      </div>
                    </div>
                  </div>

                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="tempo-uso-benfeitoria-1">Tempo de Uso (anos)</label>
                      <div class="input-group">
                        <input
                          class="form-control"
                          type="number"
                          id="tempo-uso-benfeitoria-1"
                          name="tempo-uso"
                        />                        
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="porcentagem-caprinos-benfeitoria-1"
                        >Uso para Caprinos</label
                      >
                      <div class="input-group">
                        <input
                          id="porcentagem-caprinos-benfeitoria-1"
                          type="number"
                          class="form-control"
                          name="uso-caprinos"
                        />
                        <div class="input-group-append">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >%</span
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="porcentagem-ovinos-benfeitoria-1"
                        >Uso para Ovinos</label
                      >
                      <div class="input-group">
                        <input
                          id="porcentagem-ovinos-benfeitoria-1"
                          type="number"
                          class="form-control"
                          name="uso-ovinos"
                        />
                        <div class="input-group-append">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >%</span
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row justify-content-center">
                  <button class="btn btn-link" name="button" id="adicionar-animal-trabalho">
                    <span class="position-relative" style="font-weight: bold;"
                      >Adicionar Outro Animal de Trabalho &nbsp;</span
                    >
                  </button>
                </div>

                <div class="form-group text-center my-5">
                  <a
                    href="cadastrar-propriedade2.html"
                    class="btn btn-dark width-md btn-rounded"
                    type="reset"
                  >
                    <i class="fas fa-arrow-circle-left"></i>
                    Voltar
                  </a>
                  <button                    
                    class="btn btn-danger width-md btn-rounded"
                    type="reset"
                    id="cadastrar-animais-retornar"
                  >
                    Cadastrar e Retornar
                  </button>                  
                </div>
              </form>
            </div>
            <!-- end card -->
          </div>
          <!-- end col -->
        </div>
        <!-- end row -->
      </div>
      <!-- end container -->
    </div>
    <!-- end page -->

    <!-- Vendor js -->
    <script src="assets/js/vendor.min.js"></script>

    <!-- Bootstrap select plugin -->
    <script src="assets/libs/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="assets/libs/select2/select2.min.js"></script>
    <!-- Plugins js -->
    <script src="assets/libs/jquery-mask-plugin/jquery.mask.min.js"></script>
    <script src="assets/libs/autonumeric/autoNumeric-min.js"></script>
    <script src="assets/js/pages/form-masks.init.js"></script>

    <!-- App js -->
    <script src="assets/js/app.min.js"></script>

    <script type="text/javascript">
      function adicionarOutro(){
        let select = document.getElementById('animais-trabalho').value
        
        let outro = document.getElementById('outro-animal-div')

        if(select === '-1'){          
          outro.className = "form-group d-block"
        }else{
          outro.className = "form-group d-none"
        }        
      }

      function cadastrarAnimalTrabalho(){
        $('#adicionar-animal-trabalho').click(function(event){          
          event.preventDefault()

          tratarValores('#valor-animal')          

          let data = $('#form-animais-trabalho').serialize()                    

          url = 'http://localhost/php-getovi/api/cadastro_animais_trabalho.php';          
          

          $.ajax({
            url: url,
            method: 'POST',
            data: data,
            dataType: 'json'
          }).done(function(res){
            if(res.status == 'Success'){
              
              window.alert(res.value)

              window.location.href = 'cadastrar-animais-trabalho.html'                          
            }else{
              console.log(res.value)              
              window.alert('Erro')
            }
          })     
        })
      }

      function cadastrarRetornar(){
        $('#cadastrar-animais-retornar').click(function(event){          
          event.preventDefault()

          tratarValores('#valor-animal')          

          let data = $('#form-animais-trabalho').serialize()                    

          url = 'http://localhost/php-getovi/api/cadastro_animais_trabalho.php';          
          

          $.ajax({
            url: url,
            method: 'POST',
            data: data,
            dataType: 'json'
          }).done(function(res){
            if(res.status == 'Success'){
              
              window.alert(res.value)

              window.location.href = 'cadastrar-propriedade2.html'                          
            }else{
              console.log(res.value)              
              window.alert('Erro')
            }
          })     
        })
      }

      function tratarValores(id){
        let valor = $(id).val()
          valor = valor.replace('.','')
          valor = parseFloat(valor.replace(',','.'))
          $(id).val(valor)
      }      

      cadastrarAnimalTrabalho()
      cadastrarRetornar()
    </script>
  </body>
</html>
