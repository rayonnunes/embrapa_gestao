<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="utf-8" />
    <title>Cadastrar Estrutura da Propriedade - Emprapa</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta
      content="A fully featured admin theme which can be used to build CRM, CMS, etc."
      name="description"
    />
    <meta content="Coderthemes" name="author" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- App favicon -->
    <link rel="shortcut icon" href="assets/images/favicon.ico" />

    <!-- Bootstrap select pluings -->
    <link
      href="assets/libs/bootstrap-select/bootstrap-select.min.css"
      rel="stylesheet"
      type="text/css"
    />

    <!-- App css -->
    <link
      href="assets/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <link href="assets/css/icons.min.css" rel="stylesheet" type="text/css" />
    <link href="assets/css/app.min.css" rel="stylesheet" type="text/css" />
  </head>

  <body class="bg-white">
    <div id="wrapper">
      @@include('./partials/topbar-initial.html')
    </div>
    <div class="account-pages my-5">
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-md-8 col-lg-6 col-xl-5">
            <div>
              <div class="text-center mb-4">
                <h2>Cadastrar Estrutura da Propriedade</h2>
                <h3>
                  Equipamentos e Veículos
                </h3>
              </div>

              <form id="form-equipamentos">
                <div class="form-group mb-3">
                  <label for="equipamentos-princ-1"
                    >Selecione o Equipamento</label
                  >
                  <select
                    class="form-control select2"
                    id="equipamentos-princ-1"
                    name="nome-equipamento"
                    onchange="adicionarOutro()"
                  >
                    <option>Selecione</option>
                    <optgroup label="Equipamento/Veículos">
                      <option value="Trator">Trator</option>
                      <option value="Implementos">Implementos</option>
                      <option value="Roçadeira Manual">Roçadeira Manual</option>
                      <option value="Carro de Boi">Carro de Boi</option>
                      <option value="Carroças">Carroças</option>
                      <option value="Triturador, Picadeira, Forrageira ou Desintegrador"
                        >Triturador, Picadeira, Forrageira ou
                        Desintegrador</option
                      >
                      <option value="Arreios ou Selaria">Arreios ou Selaria </option>
                      <option value="Ferramentas">Ferramentas</option>
                      <option value="Bombas D'água">Bombas D'água</option>
                      <option value="Gerador de Energia">Gerador de Energia</option>
                      <option value="Motosserra">Motosserra</option>
                      <option value="Pistola de Vacinação">Pistola de Vacinação</option>
                      <option value="Pulverizador Costal">Pulverizador Costal</option>
                      <option value="Botijão de Sêmen">Botijão de Sêmen</option>
                      <option value="Tambor de Leite">Tambor de Leite</option>
                      <option value="Ordenha - Balde ao pé (conjunto)"
                        >Ordenha - Balde ao pé (conjunto)</option
                      >
                      <option value="Ordenha Mecânica">Ordenha Mecânica (conjunto)</option>
                      <option value="Tanque de Expansão">Tanque de Expansão</option>
                      <option value="Resfriador de Leite">Resfriador de Leite</option>
                      <option value="Lavadora a Jato">Lavadora à Jato</option>
                      <option value="Balança">Balança</option>
                      <option value="Antena">Antena</option>
                      <option value="Telefone">Telefone</option>
                      <option value="Caminhonete">Caminhonete</option>
                      <option value="Carro Leve">Carro Leve</option>
                      <option value="Moto">Moto</option>
                      <option value="Caminhão">Caminhão</option>
                      <option value="Tanque de Combustível">Tanque de Combustível</option>
                      <option value="Motobomba">Motobomba</option>
                      <option value="Motor">Motor</option>
                      <option value="Kit de Ordenha">Kit de Ordenha</option>
                    </optgroup>
                    <optgroup>
                      <option value="-1">Outro (Informe...)</option>
                    </optgroup>
                  </select>
                </div>

                <div class="form-group d-none" id="outro-equipamento-div">
                  <label for="outra-benfeitoria-nome-1">Outro</label>
                  <input
                    id="outro-equipamento"
                    type="text"
                    class="form-control"
                    name="outro"                    
                  />
                </div>

                <div class="form-group mb-3">
                  <label for="detalhes-benfeitoria-principal-1"
                    >Características</label
                  >
                  <input
                    id="detalhes-benfeitoria-principal-1"
                    type="text"
                    class="form-control"
                    name="caracteristica"
                  />
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="quantidade-benfeitoria-principal-1"
                        >Quantidade</label
                      >
                      <input
                        id="quantidade-benfeitoria-principal-1"
                        type="number"
                        class="form-control"
                        name="qtd"
                      />
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="valor-benfeitoria-1">Valor do Bem</label>
                      <div class="input-group">
                        <div class="input-group-prepend">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >R$</span
                          >
                        </div>
                        <input
                          id="valor-equipamento"
                          type="text"
                          class="form-control"
                          data-toggle="input-mask"
                          data-mask-format="000.000.000.000.000,00"
                          data-reverse="true"
                          name="valor"
                        />
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="vida-util-benfeitoria-1"
                        >Vida Útil do Bem (Anos)</label
                      >
                      <div class="input-group">
                        <input
                          class="form-control"
                          type="number"
                          id="vida-util-benfeitoria-1"
                          name="vida-util"
                        />                        
                      </div>
                    </div>
                  </div>

                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="tempo-uso-benfeitoria-1">Tempo de Uso (Anos)</label>
                      <div class="input-group">
                        <input
                          class="form-control"
                          type="number"
                          id="tempo-uso-benfeitoria-1"
                          name="tempo-uso"
                        />                        
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row">
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="porcentagem-caprinos-benfeitoria-1"
                        >Uso para Caprinos</label
                      >
                      <div class="input-group">
                        <input
                          id="porcentagem-caprinos-benfeitoria-1"
                          type="number"
                          class="form-control"
                          name="uso-caprinos"
                        />
                        <div class="input-group-append">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >%</span
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="col">
                    <div class="form-group mb-3">
                      <label for="porcentagem-ovinos-benfeitoria-1"
                        >Uso para Ovinos</label
                      >
                      <div class="input-group">
                        <input
                          id="porcentagem-ovinos-benfeitoria-1"
                          type="number"
                          class="form-control"
                          name="uso-ovinos"
                        />
                        <div class="input-group-append">
                          <span
                            class="input-group-text bg-primary text-white b-0"
                            >%</span
                          >
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="row justify-content-center">
                  <button class="btn btn-link" name="button" id="adicionar-equipamento">
                    <span class="position-relative" style="font-weight: bold;"
                      >Adicionar Outro Equipamento &nbsp;</span
                    >
                  </button>
                </div>

                <div class="form-group text-center my-5">
                  <a
                    href="cadastrar-benfeitorias.html"
                    class="btn btn-dark width-md btn-rounded"
                    type="reset"
                  >
                    <i class="fas fa-arrow-circle-left"></i>
                    Voltar
                  </a>
                  <a
                    href="cadastrar-propriedade2.html"
                    class="btn btn-danger width-md btn-rounded"
                    type="reset"
                  >
                    Retornar Cadastro Inicial
                  </a>
                  <a
                    href="cadastrar-animais-trabalho.html"
                    class="btn btn-success width-md btn-rounded"
                  >
                    Próximo &nbsp;
                    <i class="fas fa-arrow-circle-right"></i>
                  </a>
                </div>
              </form>
            </div>
            <!-- end card -->
          </div>
          <!-- end col -->
        </div>
        <!-- end row -->
      </div>
      <!-- end container -->
    </div>
    <!-- end page -->

    <!-- Vendor js -->
    <script src="assets/js/vendor.min.js"></script>

    <!-- Bootstrap select plugin -->
    <script src="assets/libs/bootstrap-select/bootstrap-select.min.js"></script>
    <script src="assets/libs/select2/select2.min.js"></script>
    <!-- Plugins js -->
    <script src="assets/libs/jquery-mask-plugin/jquery.mask.min.js"></script>
    <script src="assets/libs/autonumeric/autoNumeric-min.js"></script>
    <script src="assets/js/pages/form-masks.init.js"></script>

    <!-- App js -->
    <script src="assets/js/app.min.js"></script>

    <script type="text/javascript">
      function adicionarOutro(){
        let select = document.getElementById('equipamentos-princ-1').value
        
        let outroEquipamento = document.getElementById('outro-equipamento-div')

        if(select === '-1'){          
          outroEquipamento.className = "form-group d-block"
        }else{
          outroEquipamento.className = "form-group d-none"
        }        
      }

      function cadastrarEquipamento(){
        $('#adicionar-equipamento').click(function(event){          
          event.preventDefault()

          tratarValores('#valor-equipamento')          

          let data = $('#form-equipamentos').serialize()                    

          url = 'http://localhost/php-getovi/api/cadastro_equipamento.php';          
          

          $.ajax({
            url: url,
            method: 'POST',
            data: data,
            dataType: 'json'
          }).done(function(res){
            if(res.status == 'Success'){
              
              window.alert(res.value)

              window.location.href = 'cadastrar-equipamentos.html'                          
            }else{
              console.log(res.value)              
              window.alert('Erro')
            }
          })     
        })
      }

      function tratarValores(id){
        let valor = $(id).val()
          valor = valor.replace('.','')
          valor = parseFloat(valor.replace(',','.'))
          $(id).val(valor)
      }      

      cadastrarEquipamento()
    </script>
  </body>
</html>
